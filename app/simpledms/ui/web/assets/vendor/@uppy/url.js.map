{
  "version": 3,
  "sources": ["../../../../../node_modules/retry/lib/retry_operation.js", "../../../../../node_modules/retry/lib/retry.js", "../../../../../node_modules/retry/index.js", "../../../../../node_modules/@uppy/utils/lib/UserFacingApiError.js", "../../../../../node_modules/p-retry/index.js", "../../../../../node_modules/is-network-error/index.js", "../../../../../node_modules/@uppy/utils/lib/fetchWithNetworkError.js", "../../../../../node_modules/@uppy/utils/lib/hasProperty.js", "../../../../../node_modules/@uppy/utils/lib/ErrorWithCause.js", "../../../../../node_modules/@uppy/utils/lib/getSocketHost.js", "../../../../../node_modules/@uppy/companion-client/lib/AuthError.js", "../../../../../node_modules/@uppy/companion-client/lib/RequestClient.js", "../../../../../node_modules/@uppy/url/node_modules/nanoid/non-secure/index.js", "../../../../../node_modules/@uppy/url/lib/UrlUI.js", "../../../../../node_modules/@uppy/url/lib/utils/forEachDroppedOrPastedUrl.js", "../../../../../node_modules/@uppy/url/lib/locale.js", "../../../../../node_modules/@uppy/url/lib/Url.js"],
  "sourcesContent": ["function RetryOperation(timeouts, options) {\n  // Compatibility for the old (timeouts, retryForever) signature\n  if (typeof options === 'boolean') {\n    options = { forever: options };\n  }\n\n  this._originalTimeouts = JSON.parse(JSON.stringify(timeouts));\n  this._timeouts = timeouts;\n  this._options = options || {};\n  this._maxRetryTime = options && options.maxRetryTime || Infinity;\n  this._fn = null;\n  this._errors = [];\n  this._attempts = 1;\n  this._operationTimeout = null;\n  this._operationTimeoutCb = null;\n  this._timeout = null;\n  this._operationStart = null;\n  this._timer = null;\n\n  if (this._options.forever) {\n    this._cachedTimeouts = this._timeouts.slice(0);\n  }\n}\nmodule.exports = RetryOperation;\n\nRetryOperation.prototype.reset = function() {\n  this._attempts = 1;\n  this._timeouts = this._originalTimeouts.slice(0);\n}\n\nRetryOperation.prototype.stop = function() {\n  if (this._timeout) {\n    clearTimeout(this._timeout);\n  }\n  if (this._timer) {\n    clearTimeout(this._timer);\n  }\n\n  this._timeouts       = [];\n  this._cachedTimeouts = null;\n};\n\nRetryOperation.prototype.retry = function(err) {\n  if (this._timeout) {\n    clearTimeout(this._timeout);\n  }\n\n  if (!err) {\n    return false;\n  }\n  var currentTime = new Date().getTime();\n  if (err && currentTime - this._operationStart >= this._maxRetryTime) {\n    this._errors.push(err);\n    this._errors.unshift(new Error('RetryOperation timeout occurred'));\n    return false;\n  }\n\n  this._errors.push(err);\n\n  var timeout = this._timeouts.shift();\n  if (timeout === undefined) {\n    if (this._cachedTimeouts) {\n      // retry forever, only keep last error\n      this._errors.splice(0, this._errors.length - 1);\n      timeout = this._cachedTimeouts.slice(-1);\n    } else {\n      return false;\n    }\n  }\n\n  var self = this;\n  this._timer = setTimeout(function() {\n    self._attempts++;\n\n    if (self._operationTimeoutCb) {\n      self._timeout = setTimeout(function() {\n        self._operationTimeoutCb(self._attempts);\n      }, self._operationTimeout);\n\n      if (self._options.unref) {\n          self._timeout.unref();\n      }\n    }\n\n    self._fn(self._attempts);\n  }, timeout);\n\n  if (this._options.unref) {\n      this._timer.unref();\n  }\n\n  return true;\n};\n\nRetryOperation.prototype.attempt = function(fn, timeoutOps) {\n  this._fn = fn;\n\n  if (timeoutOps) {\n    if (timeoutOps.timeout) {\n      this._operationTimeout = timeoutOps.timeout;\n    }\n    if (timeoutOps.cb) {\n      this._operationTimeoutCb = timeoutOps.cb;\n    }\n  }\n\n  var self = this;\n  if (this._operationTimeoutCb) {\n    this._timeout = setTimeout(function() {\n      self._operationTimeoutCb();\n    }, self._operationTimeout);\n  }\n\n  this._operationStart = new Date().getTime();\n\n  this._fn(this._attempts);\n};\n\nRetryOperation.prototype.try = function(fn) {\n  console.log('Using RetryOperation.try() is deprecated');\n  this.attempt(fn);\n};\n\nRetryOperation.prototype.start = function(fn) {\n  console.log('Using RetryOperation.start() is deprecated');\n  this.attempt(fn);\n};\n\nRetryOperation.prototype.start = RetryOperation.prototype.try;\n\nRetryOperation.prototype.errors = function() {\n  return this._errors;\n};\n\nRetryOperation.prototype.attempts = function() {\n  return this._attempts;\n};\n\nRetryOperation.prototype.mainError = function() {\n  if (this._errors.length === 0) {\n    return null;\n  }\n\n  var counts = {};\n  var mainError = null;\n  var mainErrorCount = 0;\n\n  for (var i = 0; i < this._errors.length; i++) {\n    var error = this._errors[i];\n    var message = error.message;\n    var count = (counts[message] || 0) + 1;\n\n    counts[message] = count;\n\n    if (count >= mainErrorCount) {\n      mainError = error;\n      mainErrorCount = count;\n    }\n  }\n\n  return mainError;\n};\n", "var RetryOperation = require('./retry_operation');\n\nexports.operation = function(options) {\n  var timeouts = exports.timeouts(options);\n  return new RetryOperation(timeouts, {\n      forever: options && (options.forever || options.retries === Infinity),\n      unref: options && options.unref,\n      maxRetryTime: options && options.maxRetryTime\n  });\n};\n\nexports.timeouts = function(options) {\n  if (options instanceof Array) {\n    return [].concat(options);\n  }\n\n  var opts = {\n    retries: 10,\n    factor: 2,\n    minTimeout: 1 * 1000,\n    maxTimeout: Infinity,\n    randomize: false\n  };\n  for (var key in options) {\n    opts[key] = options[key];\n  }\n\n  if (opts.minTimeout > opts.maxTimeout) {\n    throw new Error('minTimeout is greater than maxTimeout');\n  }\n\n  var timeouts = [];\n  for (var i = 0; i < opts.retries; i++) {\n    timeouts.push(this.createTimeout(i, opts));\n  }\n\n  if (options && options.forever && !timeouts.length) {\n    timeouts.push(this.createTimeout(i, opts));\n  }\n\n  // sort the array numerically ascending\n  timeouts.sort(function(a,b) {\n    return a - b;\n  });\n\n  return timeouts;\n};\n\nexports.createTimeout = function(attempt, opts) {\n  var random = (opts.randomize)\n    ? (Math.random() + 1)\n    : 1;\n\n  var timeout = Math.round(random * Math.max(opts.minTimeout, 1) * Math.pow(opts.factor, attempt));\n  timeout = Math.min(timeout, opts.maxTimeout);\n\n  return timeout;\n};\n\nexports.wrap = function(obj, options, methods) {\n  if (options instanceof Array) {\n    methods = options;\n    options = null;\n  }\n\n  if (!methods) {\n    methods = [];\n    for (var key in obj) {\n      if (typeof obj[key] === 'function') {\n        methods.push(key);\n      }\n    }\n  }\n\n  for (var i = 0; i < methods.length; i++) {\n    var method   = methods[i];\n    var original = obj[method];\n\n    obj[method] = function retryWrapper(original) {\n      var op       = exports.operation(options);\n      var args     = Array.prototype.slice.call(arguments, 1);\n      var callback = args.pop();\n\n      args.push(function(err) {\n        if (op.retry(err)) {\n          return;\n        }\n        if (err) {\n          arguments[0] = op.mainError();\n        }\n        callback.apply(this, arguments);\n      });\n\n      op.attempt(function() {\n        original.apply(obj, args);\n      });\n    }.bind(obj, original);\n    obj[method].options = options;\n  }\n};\n", "module.exports = require('./lib/retry');", "class UserFacingApiError extends Error {\n  constructor() {\n    super(...arguments);\n    this.name = 'UserFacingApiError';\n  }\n}\nexport default UserFacingApiError;", "import retry from 'retry';\nimport isNetworkError from 'is-network-error';\n\nexport class AbortError extends Error {\n\tconstructor(message) {\n\t\tsuper();\n\n\t\tif (message instanceof Error) {\n\t\t\tthis.originalError = message;\n\t\t\t({message} = message);\n\t\t} else {\n\t\t\tthis.originalError = new Error(message);\n\t\t\tthis.originalError.stack = this.stack;\n\t\t}\n\n\t\tthis.name = 'AbortError';\n\t\tthis.message = message;\n\t}\n}\n\nconst decorateErrorWithCounts = (error, attemptNumber, options) => {\n\t// Minus 1 from attemptNumber because the first attempt does not count as a retry\n\tconst retriesLeft = options.retries - (attemptNumber - 1);\n\n\terror.attemptNumber = attemptNumber;\n\terror.retriesLeft = retriesLeft;\n\treturn error;\n};\n\nexport default async function pRetry(input, options) {\n\treturn new Promise((resolve, reject) => {\n\t\toptions = {...options};\n\t\toptions.onFailedAttempt ??= () => {};\n\t\toptions.shouldRetry ??= () => true;\n\t\toptions.retries ??= 10;\n\n\t\tconst operation = retry.operation(options);\n\n\t\tconst abortHandler = () => {\n\t\t\toperation.stop();\n\t\t\treject(options.signal?.reason);\n\t\t};\n\n\t\tif (options.signal && !options.signal.aborted) {\n\t\t\toptions.signal.addEventListener('abort', abortHandler, {once: true});\n\t\t}\n\n\t\tconst cleanUp = () => {\n\t\t\toptions.signal?.removeEventListener('abort', abortHandler);\n\t\t\toperation.stop();\n\t\t};\n\n\t\toperation.attempt(async attemptNumber => {\n\t\t\ttry {\n\t\t\t\tconst result = await input(attemptNumber);\n\t\t\t\tcleanUp();\n\t\t\t\tresolve(result);\n\t\t\t} catch (error) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!(error instanceof Error)) {\n\t\t\t\t\t\tthrow new TypeError(`Non-error was thrown: \"${error}\". You should only throw errors.`);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (error instanceof AbortError) {\n\t\t\t\t\t\tthrow error.originalError;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (error instanceof TypeError && !isNetworkError(error)) {\n\t\t\t\t\t\tthrow error;\n\t\t\t\t\t}\n\n\t\t\t\t\tdecorateErrorWithCounts(error, attemptNumber, options);\n\n\t\t\t\t\tif (!(await options.shouldRetry(error))) {\n\t\t\t\t\t\toperation.stop();\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t}\n\n\t\t\t\t\tawait options.onFailedAttempt(error);\n\n\t\t\t\t\tif (!operation.retry(error)) {\n\t\t\t\t\t\tthrow operation.mainError();\n\t\t\t\t\t}\n\t\t\t\t} catch (finalError) {\n\t\t\t\t\tdecorateErrorWithCounts(finalError, attemptNumber, options);\n\t\t\t\t\tcleanUp();\n\t\t\t\t\treject(finalError);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t});\n}\n", "const objectToString = Object.prototype.toString;\n\nconst isError = value => objectToString.call(value) === '[object Error]';\n\nconst errorMessages = new Set([\n\t'network error', // Chrome\n\t'Failed to fetch', // Chrome\n\t'NetworkError when attempting to fetch resource.', // Firefox\n\t'The Internet connection appears to be offline.', // Safari 16\n\t'Load failed', // Safari 17+\n\t'Network request failed', // `cross-fetch`\n\t'fetch failed', // Undici (Node.js)\n\t'terminated', // Undici (Node.js)\n]);\n\nexport default function isNetworkError(error) {\n\tconst isValid = error\n\t\t&& isError(error)\n\t\t&& error.name === 'TypeError'\n\t\t&& typeof error.message === 'string';\n\n\tif (!isValid) {\n\t\treturn false;\n\t}\n\n\t// We do an extra check for Safari 17+ as it has a very generic error message.\n\t// Network errors in Safari have no stack.\n\tif (error.message === 'Load failed') {\n\t\treturn error.stack === undefined;\n\t}\n\n\treturn errorMessages.has(error.message);\n}\n", "import NetworkError from './NetworkError.js';\n\n/**\n * Wrapper around window.fetch that throws a NetworkError when appropriate\n */\nexport default function fetchWithNetworkError() {\n  return fetch(...arguments).catch(err => {\n    if (err.name === 'AbortError') {\n      throw err;\n    } else {\n      throw new NetworkError(err);\n    }\n  });\n}", "export default function has(object, key) {\n  return Object.prototype.hasOwnProperty.call(object, key);\n}", "import hasProperty from './hasProperty.js';\nclass ErrorWithCause extends Error {\n  constructor(message, options) {\n    super(message);\n    this.cause = options == null ? void 0 : options.cause;\n    if (this.cause && hasProperty(this.cause, 'isNetworkError')) {\n      this.isNetworkError = this.cause.isNetworkError;\n    } else {\n      this.isNetworkError = false;\n    }\n  }\n}\nexport default ErrorWithCause;", "export default function getSocketHost(url) {\n  var _regex$exec;\n  // get the host domain\n  const regex = /^(?:https?:\\/\\/|\\/\\/)?(?:[^@\\n]+@)?([^\\n]+)/i;\n  const host = (_regex$exec = regex.exec(url)) == null ? void 0 : _regex$exec[1];\n  const socketProtocol = /^http:\\/\\//i.test(url) ? 'ws' : 'wss';\n  return `${socketProtocol}://${host}`;\n}", "'use strict';\n\nclass AuthError extends Error {\n  constructor() {\n    super('Authorization required');\n    this.name = 'AuthError';\n\n    // we use a property because of instanceof is unsafe:\n    // https://github.com/transloadit/uppy/pull/4619#discussion_r1406225982\n    this.isAuthError = true;\n  }\n}\nexport default AuthError;", "function _classPrivateFieldLooseBase(e, t) { if (!{}.hasOwnProperty.call(e, t)) throw new TypeError(\"attempted to use private field on non-instance\"); return e; }\nvar id = 0;\nfunction _classPrivateFieldLooseKey(e) { return \"__private_\" + id++ + \"_\" + e; }\nimport UserFacingApiError from '@uppy/utils/lib/UserFacingApiError';\n// eslint-disable-next-line import/no-extraneous-dependencies\nimport pRetry, { AbortError } from 'p-retry';\nimport fetchWithNetworkError from '@uppy/utils/lib/fetchWithNetworkError';\nimport ErrorWithCause from '@uppy/utils/lib/ErrorWithCause';\nimport getSocketHost from '@uppy/utils/lib/getSocketHost';\nimport AuthError from './AuthError.js';\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore We don't want TS to generate types for the package.json\nconst packageJson = {\n  \"version\": \"4.4.1\"\n};\n// Remove the trailing slash so we can always safely append /xyz.\nfunction stripSlash(url) {\n  return url.replace(/\\/$/, '');\n}\nconst retryCount = 10; // set to a low number, like 2 to test manual user retries\nconst socketActivityTimeoutMs = 5 * 60 * 1000; // set to a low number like 10000 to test this\n\nexport const authErrorStatusCode = 401;\nclass HttpError extends Error {\n  constructor(_ref) {\n    let {\n      statusCode,\n      message\n    } = _ref;\n    super(message);\n    this.name = 'HttpError';\n    this.statusCode = statusCode;\n  }\n}\nasync function handleJSONResponse(res) {\n  if (res.status === authErrorStatusCode) {\n    throw new AuthError();\n  }\n  if (res.ok) {\n    return res.json();\n  }\n  let errMsg = `Failed request with status: ${res.status}. ${res.statusText}`;\n  let errData;\n  try {\n    errData = await res.json();\n    if (errData.message) errMsg = `${errMsg} message: ${errData.message}`;\n    if (errData.requestId) errMsg = `${errMsg} request-Id: ${errData.requestId}`;\n  } catch (cause) {\n    // if the response contains invalid JSON, let's ignore the error data\n    throw new Error(errMsg, {\n      cause\n    });\n  }\n  if (res.status >= 400 && res.status <= 499 && errData.message) {\n    throw new UserFacingApiError(errData.message);\n  }\n  throw new HttpError({\n    statusCode: res.status,\n    message: errMsg\n  });\n}\nfunction emitSocketProgress(uploader, progressData, file) {\n  const {\n    progress,\n    bytesUploaded,\n    bytesTotal\n  } = progressData;\n  if (progress) {\n    var _file$progress$upload;\n    uploader.uppy.log(`Upload progress: ${progress}`);\n    uploader.uppy.emit('upload-progress', file, {\n      uploadStarted: (_file$progress$upload = file.progress.uploadStarted) != null ? _file$progress$upload : 0,\n      bytesUploaded,\n      bytesTotal\n    });\n  }\n}\nvar _companionHeaders = /*#__PURE__*/_classPrivateFieldLooseKey(\"companionHeaders\");\nvar _getUrl = /*#__PURE__*/_classPrivateFieldLooseKey(\"getUrl\");\nvar _requestSocketToken = /*#__PURE__*/_classPrivateFieldLooseKey(\"requestSocketToken\");\nvar _awaitRemoteFileUpload = /*#__PURE__*/_classPrivateFieldLooseKey(\"awaitRemoteFileUpload\");\nexport default class RequestClient {\n  constructor(uppy, opts) {\n    /**\n     * This method will ensure a websocket for the specified file and returns a promise that resolves\n     * when the file has finished downloading, or rejects if it fails.\n     * It will retry if the websocket gets disconnected\n     */\n    Object.defineProperty(this, _awaitRemoteFileUpload, {\n      value: _awaitRemoteFileUpload2\n    });\n    Object.defineProperty(this, _getUrl, {\n      value: _getUrl2\n    });\n    Object.defineProperty(this, _companionHeaders, {\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, _requestSocketToken, {\n      writable: true,\n      value: async _ref2 => {\n        var _file$remote;\n        let {\n          file,\n          postBody,\n          signal\n        } = _ref2;\n        if (((_file$remote = file.remote) == null ? void 0 : _file$remote.url) == null) {\n          throw new Error('Cannot connect to an undefined URL');\n        }\n        const res = await this.post(file.remote.url, {\n          ...file.remote.body,\n          ...postBody\n        }, {\n          signal\n        });\n        return res.token;\n      }\n    });\n    this.uppy = uppy;\n    this.opts = opts;\n    this.onReceiveResponse = this.onReceiveResponse.bind(this);\n    _classPrivateFieldLooseBase(this, _companionHeaders)[_companionHeaders] = opts.companionHeaders;\n  }\n  setCompanionHeaders(headers) {\n    _classPrivateFieldLooseBase(this, _companionHeaders)[_companionHeaders] = headers;\n  }\n  [Symbol.for('uppy test: getCompanionHeaders')]() {\n    return _classPrivateFieldLooseBase(this, _companionHeaders)[_companionHeaders];\n  }\n  get hostname() {\n    const {\n      companion\n    } = this.uppy.getState();\n    const host = this.opts.companionUrl;\n    return stripSlash(companion && companion[host] ? companion[host] : host);\n  }\n  async headers(emptyBody) {\n    if (emptyBody === void 0) {\n      emptyBody = false;\n    }\n    const defaultHeaders = {\n      Accept: 'application/json',\n      ...(emptyBody ? undefined : {\n        // Passing those headers on requests with no data forces browsers to first make a preflight request.\n        'Content-Type': 'application/json'\n      })\n    };\n    return {\n      ...defaultHeaders,\n      ..._classPrivateFieldLooseBase(this, _companionHeaders)[_companionHeaders]\n    };\n  }\n  onReceiveResponse(res) {\n    const {\n      headers\n    } = res;\n    const state = this.uppy.getState();\n    const companion = state.companion || {};\n    const host = this.opts.companionUrl;\n\n    // Store the self-identified domain name for the Companion instance we just hit.\n    if (headers.has('i-am') && headers.get('i-am') !== companion[host]) {\n      this.uppy.setState({\n        companion: {\n          ...companion,\n          [host]: headers.get('i-am')\n        }\n      });\n    }\n  }\n  async request(_ref3) {\n    let {\n      path,\n      method = 'GET',\n      data,\n      skipPostResponse,\n      signal\n    } = _ref3;\n    try {\n      const headers = await this.headers(!data);\n      const response = await fetchWithNetworkError(_classPrivateFieldLooseBase(this, _getUrl)[_getUrl](path), {\n        method,\n        signal,\n        headers,\n        credentials: this.opts.companionCookiesRule || 'same-origin',\n        body: data ? JSON.stringify(data) : null\n      });\n      if (!skipPostResponse) this.onReceiveResponse(response);\n      return await handleJSONResponse(response);\n    } catch (err) {\n      // pass these through\n      if (err.isAuthError || err.name === 'UserFacingApiError' || err.name === 'AbortError') throw err;\n      throw new ErrorWithCause(`Could not ${method} ${_classPrivateFieldLooseBase(this, _getUrl)[_getUrl](path)}`, {\n        cause: err\n      });\n    }\n  }\n  async get(path, options) {\n    return this.request({\n      ...options,\n      path\n    });\n  }\n  async post(path, data, options) {\n    return this.request({\n      ...options,\n      path,\n      method: 'POST',\n      data\n    });\n  }\n  async delete(path, data, options) {\n    return this.request({\n      ...options,\n      path,\n      method: 'DELETE',\n      data\n    });\n  }\n\n  /**\n   * Remote uploading consists of two steps:\n   * 1. #requestSocketToken which starts the download/upload in companion and returns a unique token for the upload.\n   * Then companion will halt the upload until:\n   * 2. #awaitRemoteFileUpload is called, which will open/ensure a websocket connection towards companion, with the\n   * previously generated token provided. It returns a promise that will resolve/reject once the file has finished\n   * uploading or is otherwise done (failed, canceled)\n   */\n  async uploadRemoteFile(file, reqBody, options) {\n    var _this = this;\n    try {\n      const {\n        signal,\n        getQueue\n      } = options || {};\n      return await pRetry(async () => {\n        var _this$uppy$getFile;\n        // if we already have a serverToken, assume that we are resuming the existing server upload id\n        const existingServerToken = (_this$uppy$getFile = this.uppy.getFile(file.id)) == null ? void 0 : _this$uppy$getFile.serverToken;\n        if (existingServerToken != null) {\n          this.uppy.log(`Connecting to exiting websocket ${existingServerToken}`);\n          return _classPrivateFieldLooseBase(this, _awaitRemoteFileUpload)[_awaitRemoteFileUpload]({\n            file,\n            queue: getQueue(),\n            signal\n          });\n        }\n        const queueRequestSocketToken = getQueue().wrapPromiseFunction(async function () {\n          try {\n            return await _classPrivateFieldLooseBase(_this, _requestSocketToken)[_requestSocketToken](...arguments);\n          } catch (outerErr) {\n            // throwing AbortError will cause p-retry to stop retrying\n            if (outerErr.isAuthError) throw new AbortError(outerErr);\n            if (outerErr.cause == null) throw outerErr;\n            const err = outerErr.cause;\n            const isRetryableHttpError = () => [408, 409, 429, 418, 423].includes(err.statusCode) || err.statusCode >= 500 && err.statusCode <= 599 && ![501, 505].includes(err.statusCode);\n            if (err.name === 'HttpError' && !isRetryableHttpError()) throw new AbortError(err);\n\n            // p-retry will retry most other errors,\n            // but it will not retry TypeError (except network error TypeErrors)\n            throw err;\n          }\n        }, {\n          priority: -1\n        });\n        const serverToken = await queueRequestSocketToken({\n          file,\n          postBody: reqBody,\n          signal\n        }).abortOn(signal);\n        if (!this.uppy.getFile(file.id)) return undefined; // has file since been removed?\n\n        this.uppy.setFileState(file.id, {\n          serverToken\n        });\n        return _classPrivateFieldLooseBase(this, _awaitRemoteFileUpload)[_awaitRemoteFileUpload]({\n          file: this.uppy.getFile(file.id),\n          // re-fetching file because it might have changed in the meantime\n          queue: getQueue(),\n          signal\n        });\n      }, {\n        retries: retryCount,\n        signal,\n        onFailedAttempt: err => this.uppy.log(`Retrying upload due to: ${err.message}`, 'warning')\n      });\n    } catch (err) {\n      // this is a bit confusing, but note that an error with the `name` prop set to 'AbortError' (from AbortController)\n      // is not the same as `p-retry` `AbortError`\n      if (err.name === 'AbortError') {\n        // The file upload was aborted, it\u2019s not an error\n        return undefined;\n      }\n      this.uppy.emit('upload-error', file, err);\n      throw err;\n    }\n  }\n}\nfunction _getUrl2(url) {\n  if (/^(https?:|)\\/\\//.test(url)) {\n    return url;\n  }\n  return `${this.hostname}/${url}`;\n}\nasync function _awaitRemoteFileUpload2(_ref4) {\n  let {\n    file,\n    queue,\n    signal\n  } = _ref4;\n  let removeEventHandlers;\n  const {\n    capabilities\n  } = this.uppy.getState();\n  try {\n    return await new Promise((resolve, reject) => {\n      const token = file.serverToken;\n      const host = getSocketHost(file.remote.companionUrl);\n      let socket;\n      let socketAbortController;\n      let activityTimeout;\n      let {\n        isPaused\n      } = file;\n      const socketSend = (action, payload) => {\n        if (socket == null || socket.readyState !== socket.OPEN) {\n          var _socket;\n          this.uppy.log(`Cannot send \"${action}\" to socket ${file.id} because the socket state was ${String((_socket = socket) == null ? void 0 : _socket.readyState)}`, 'warning');\n          return;\n        }\n        socket.send(JSON.stringify({\n          action,\n          payload: payload != null ? payload : {}\n        }));\n      };\n      function sendState() {\n        if (!capabilities.resumableUploads) return;\n        if (isPaused) socketSend('pause');else socketSend('resume');\n      }\n      const createWebsocket = async () => {\n        if (socketAbortController) socketAbortController.abort();\n        socketAbortController = new AbortController();\n        const onFatalError = err => {\n          var _socketAbortControlle;\n          // Remove the serverToken so that a new one will be created for the retry.\n          this.uppy.setFileState(file.id, {\n            serverToken: null\n          });\n          (_socketAbortControlle = socketAbortController) == null || _socketAbortControlle.abort == null || _socketAbortControlle.abort();\n          reject(err);\n        };\n\n        // todo instead implement the ability for users to cancel / retry *currently uploading files* in the UI\n        function resetActivityTimeout() {\n          clearTimeout(activityTimeout);\n          if (isPaused) return;\n          activityTimeout = setTimeout(() => onFatalError(new Error('Timeout waiting for message from Companion socket')), socketActivityTimeoutMs);\n        }\n        try {\n          await queue.wrapPromiseFunction(async () => {\n            const reconnectWebsocket = async () =>\n            // eslint-disable-next-line promise/param-names\n            new Promise((_, rejectSocket) => {\n              socket = new WebSocket(`${host}/api/${token}`);\n              resetActivityTimeout();\n              socket.addEventListener('close', () => {\n                socket = undefined;\n                rejectSocket(new Error('Socket closed unexpectedly'));\n              });\n              socket.addEventListener('error', error => {\n                var _socket2;\n                this.uppy.log(`Companion socket error ${JSON.stringify(error)}, closing socket`, 'warning');\n                (_socket2 = socket) == null || _socket2.close(); // will 'close' event to be emitted\n              });\n              socket.addEventListener('open', () => {\n                sendState();\n              });\n              socket.addEventListener('message', e => {\n                resetActivityTimeout();\n                try {\n                  const {\n                    action,\n                    payload\n                  } = JSON.parse(e.data);\n                  switch (action) {\n                    case 'progress':\n                      {\n                        emitSocketProgress(this, payload, this.uppy.getFile(file.id));\n                        break;\n                      }\n                    case 'success':\n                      {\n                        var _payload$response, _payload$response$sta, _payload$response2, _socketAbortControlle2;\n                        // payload.response is sent from companion for xhr-upload (aka uploadMultipart in companion) and\n                        // s3 multipart (aka uploadS3Multipart)\n                        // but not for tus/transloadit (aka uploadTus)\n                        // responseText is a string which may or may not be in JSON format\n                        // this means that an upload destination of xhr or s3 multipart MUST respond with valid JSON\n                        // to companion, or the JSON.parse will crash\n                        const text = (_payload$response = payload.response) == null ? void 0 : _payload$response.responseText;\n                        this.uppy.emit('upload-success', this.uppy.getFile(file.id), {\n                          uploadURL: payload.url,\n                          status: (_payload$response$sta = (_payload$response2 = payload.response) == null ? void 0 : _payload$response2.status) != null ? _payload$response$sta : 200,\n                          body: text ? JSON.parse(text) : undefined\n                        });\n                        (_socketAbortControlle2 = socketAbortController) == null || _socketAbortControlle2.abort == null || _socketAbortControlle2.abort();\n                        resolve();\n                        break;\n                      }\n                    case 'error':\n                      {\n                        const {\n                          message\n                        } = payload.error;\n                        throw Object.assign(new Error(message), {\n                          cause: payload.error\n                        });\n                      }\n                    default:\n                      this.uppy.log(`Companion socket unknown action ${action}`, 'warning');\n                  }\n                } catch (err) {\n                  onFatalError(err);\n                }\n              });\n              const closeSocket = () => {\n                this.uppy.log(`Closing socket ${file.id}`);\n                clearTimeout(activityTimeout);\n                if (socket) socket.close();\n                socket = undefined;\n              };\n              socketAbortController.signal.addEventListener('abort', () => {\n                closeSocket();\n              });\n            });\n            await pRetry(reconnectWebsocket, {\n              retries: retryCount,\n              signal: socketAbortController.signal,\n              onFailedAttempt: () => {\n                if (socketAbortController.signal.aborted) return; // don't log in this case\n                this.uppy.log(`Retrying websocket ${file.id}`);\n              }\n            });\n          })().abortOn(socketAbortController.signal);\n        } catch (err) {\n          if (socketAbortController.signal.aborted) return;\n          onFatalError(err);\n        }\n      };\n      const pause = newPausedState => {\n        if (!capabilities.resumableUploads) return;\n        isPaused = newPausedState;\n        if (socket) sendState();\n      };\n      const onFileRemove = targetFile => {\n        var _socketAbortControlle3;\n        if (!capabilities.individualCancellation) return;\n        if (targetFile.id !== file.id) return;\n        socketSend('cancel');\n        (_socketAbortControlle3 = socketAbortController) == null || _socketAbortControlle3.abort == null || _socketAbortControlle3.abort();\n        this.uppy.log(`upload ${file.id} was removed`);\n        resolve();\n      };\n      const onCancelAll = () => {\n        var _socketAbortControlle4;\n        socketSend('cancel');\n        (_socketAbortControlle4 = socketAbortController) == null || _socketAbortControlle4.abort == null || _socketAbortControlle4.abort();\n        this.uppy.log(`upload ${file.id} was canceled`);\n        resolve();\n      };\n      const onFilePausedChange = (targetFile, newPausedState) => {\n        if ((targetFile == null ? void 0 : targetFile.id) !== file.id) return;\n        pause(newPausedState);\n      };\n      const onPauseAll = () => pause(true);\n      const onResumeAll = () => pause(false);\n      this.uppy.on('file-removed', onFileRemove);\n      this.uppy.on('cancel-all', onCancelAll);\n      this.uppy.on('upload-pause', onFilePausedChange);\n      this.uppy.on('pause-all', onPauseAll);\n      this.uppy.on('resume-all', onResumeAll);\n      removeEventHandlers = () => {\n        this.uppy.off('file-removed', onFileRemove);\n        this.uppy.off('cancel-all', onCancelAll);\n        this.uppy.off('upload-pause', onFilePausedChange);\n        this.uppy.off('pause-all', onPauseAll);\n        this.uppy.off('resume-all', onResumeAll);\n      };\n      signal.addEventListener('abort', () => {\n        var _socketAbortControlle5;\n        (_socketAbortControlle5 = socketAbortController) == null || _socketAbortControlle5.abort();\n      });\n      createWebsocket();\n    });\n  } finally {\n    // @ts-expect-error used before defined\n    removeEventHandlers == null || removeEventHandlers();\n  }\n}\nRequestClient.VERSION = packageJson.version;", "/* @ts-self-types=\"./index.d.ts\" */\nlet urlAlphabet =\n  'useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict'\nexport let customAlphabet = (alphabet, defaultSize = 21) => {\n  return (size = defaultSize) => {\n    let id = ''\n    let i = size | 0\n    while (i--) {\n      id += alphabet[(Math.random() * alphabet.length) | 0]\n    }\n    return id\n  }\n}\nexport let nanoid = (size = 21) => {\n  let id = ''\n  let i = size | 0\n  while (i--) {\n    id += urlAlphabet[(Math.random() * 64) | 0]\n  }\n  return id\n}\n", "function _classPrivateFieldLooseBase(e, t) { if (!{}.hasOwnProperty.call(e, t)) throw new TypeError(\"attempted to use private field on non-instance\"); return e; }\nvar id = 0;\nfunction _classPrivateFieldLooseKey(e) { return \"__private_\" + id++ + \"_\" + e; }\nimport { h, Component } from 'preact';\nimport { nanoid } from 'nanoid/non-secure';\nvar _handleSubmit = /*#__PURE__*/_classPrivateFieldLooseKey(\"handleSubmit\");\nclass UrlUI extends Component {\n  // Ref is always defined after render\n\n  constructor(props) {\n    super(props);\n    this.form = document.createElement('form');\n    Object.defineProperty(this, _handleSubmit, {\n      writable: true,\n      value: ev => {\n        ev.preventDefault();\n        const {\n          addFile\n        } = this.props;\n        const preparedValue = this.input.value.trim();\n        addFile(preparedValue);\n      }\n    });\n    this.form.id = nanoid();\n  }\n  componentDidMount() {\n    this.input.value = '';\n    this.form.addEventListener('submit', _classPrivateFieldLooseBase(this, _handleSubmit)[_handleSubmit]);\n    document.body.appendChild(this.form);\n  }\n  componentWillUnmount() {\n    this.form.removeEventListener('submit', _classPrivateFieldLooseBase(this, _handleSubmit)[_handleSubmit]);\n    document.body.removeChild(this.form);\n  }\n  render() {\n    const {\n      i18n\n    } = this.props;\n    return h(\"div\", {\n      className: \"uppy-Url\"\n    }, h(\"input\", {\n      className: \"uppy-u-reset uppy-c-textInput uppy-Url-input\",\n      type: \"text\",\n      \"aria-label\": i18n('enterUrlToImport'),\n      placeholder: i18n('enterUrlToImport'),\n      ref: input => {\n        this.input = input;\n      },\n      \"data-uppy-super-focusable\": true,\n      form: this.form.id\n    }), h(\"button\", {\n      className: \"uppy-u-reset uppy-c-btn uppy-c-btn-primary uppy-Url-importButton\",\n      type: \"submit\",\n      form: this.form.id\n    }, i18n('import')));\n  }\n}\nexport default UrlUI;", "import toArray from '@uppy/utils/lib/toArray';\n\n/*\n  SITUATION\n\n    1. Cross-browser dataTransfer.items\n\n      paste in chrome [Copy Image]:\n      0: {kind: \"file\", type: \"image/png\"}\n      1: {kind: \"string\", type: \"text/html\"}\n      paste in safari [Copy Image]:\n      0: {kind: \"file\", type: \"image/png\"}\n      1: {kind: \"string\", type: \"text/html\"}\n      2: {kind: \"string\", type: \"text/plain\"}\n      3: {kind: \"string\", type: \"text/uri-list\"}\n      paste in firefox [Copy Image]:\n      0: {kind: \"file\", type: \"image/png\"}\n      1: {kind: \"string\", type: \"text/html\"}\n\n      paste in chrome [Copy Image Address]:\n      0: {kind: \"string\", type: \"text/plain\"}\n      paste in safari [Copy Image Address]:\n      0: {kind: \"string\", type: \"text/plain\"}\n      1: {kind: \"string\", type: \"text/uri-list\"}\n      paste in firefox [Copy Image Address]:\n      0: {kind: \"string\", type: \"text/plain\"}\n\n      drop in chrome [from browser]:\n      0: {kind: \"string\", type: \"text/uri-list\"}\n      1: {kind: \"string\", type: \"text/html\"}\n      drop in safari [from browser]:\n      0: {kind: \"string\", type: \"text/uri-list\"}\n      1: {kind: \"string\", type: \"text/html\"}\n      2: {kind: \"file\", type: \"image/png\"}\n      drop in firefox [from browser]:\n      0: {kind: \"string\", type: \"text/uri-list\"}\n      1: {kind: \"string\", type: \"text/x-moz-url\"}\n      2: {kind: \"string\", type: \"text/plain\"}\n\n    2. We can determine if it's a 'copypaste' or a 'drop', but we can't discern between [Copy Image] and [Copy Image Address]\n\n  CONCLUSION\n\n    1. 'paste' ([Copy Image] or [Copy Image Address], we can't discern between these two)\n      Don't do anything if there is 'file' item. .handlePaste in the DashboardPlugin will deal with all 'file' items.\n      If there are no 'file' items - handle 'text/plain' items.\n\n    2. 'drop'\n      Take 'text/uri-list' items. Safari has an additional item of .kind === 'file', and you may worry about the item being\n      duplicated (first by DashboardPlugin, and then by UrlPlugin, now), but don't. Directory handling code won't pay\n      attention to this particular item of kind 'file'.\n*/\n\n/**\n * Finds all links dropped/pasted from one browser window to another.\n */\nexport default function forEachDroppedOrPastedUrl(dataTransfer, isDropOrPaste, callback) {\n  const items = toArray(dataTransfer.items);\n  let urlItems;\n  switch (isDropOrPaste) {\n    case 'paste':\n      {\n        const atLeastOneFileIsDragged = items.some(item => item.kind === 'file');\n        if (atLeastOneFileIsDragged) {\n          return;\n        }\n        urlItems = items.filter(item => item.kind === 'string' && item.type === 'text/plain');\n        break;\n      }\n    case 'drop':\n      {\n        urlItems = items.filter(item => item.kind === 'string' && item.type === 'text/uri-list');\n        break;\n      }\n    default:\n      {\n        throw new Error(`isDropOrPaste must be either 'drop' or 'paste', but it's ${isDropOrPaste}`);\n      }\n  }\n  urlItems.forEach(item => {\n    item.getAsString(urlString => callback(urlString));\n  });\n}", "export default {\n  strings: {\n    pluginNameUrl: 'Link',\n    // Label for the \"Import\" button.\n    import: 'Import',\n    // Placeholder text for the URL input.\n    enterUrlToImport: 'Enter URL to import a file',\n    // Error message shown if Companion could not load a URL.\n    failedToFetch: 'Companion failed to fetch this URL, please make sure it\u2019s correct',\n    // Error message shown if the input does not look like a URL.\n    enterCorrectUrl: 'Incorrect URL: Please make sure you are entering a direct link to a file'\n  }\n};", "var _Url;\nimport { h } from 'preact';\nimport { UIPlugin } from '@uppy/core';\nimport { RequestClient } from '@uppy/companion-client';\nimport toArray from '@uppy/utils/lib/toArray';\nimport UrlUI from \"./UrlUI.js\";\nimport forEachDroppedOrPastedUrl from './utils/forEachDroppedOrPastedUrl.js';\n\n// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n// @ts-ignore We don't want TS to generate types for the package.json\nconst packageJson = {\n  \"version\": \"4.2.3\"\n};\nimport locale from './locale.js';\nfunction UrlIcon() {\n  return h(\"svg\", {\n    \"aria-hidden\": \"true\",\n    focusable: \"false\",\n    width: \"32\",\n    height: \"32\",\n    viewBox: \"0 0 32 32\"\n  }, h(\"path\", {\n    d: \"M23.637 15.312l-2.474 2.464a3.582 3.582 0 01-.577.491c-.907.657-1.897.986-2.968.986a4.925 4.925 0 01-3.959-1.971c-.248-.329-.164-.902.165-1.149.33-.247.907-.164 1.155.164 1.072 1.478 3.133 1.724 4.618.656a.642.642 0 00.33-.328l2.473-2.463c1.238-1.313 1.238-3.366-.082-4.597a3.348 3.348 0 00-4.618 0l-1.402 1.395a.799.799 0 01-1.154 0 .79.79 0 010-1.15l1.402-1.394a4.843 4.843 0 016.843 0c2.062 1.805 2.144 5.007.248 6.896zm-8.081 5.664l-1.402 1.395a3.348 3.348 0 01-4.618 0c-1.319-1.23-1.319-3.365-.082-4.596l2.475-2.464.328-.328c.743-.492 1.567-.739 2.475-.657.906.165 1.648.574 2.143 1.314.248.329.825.411 1.155.165.33-.248.412-.822.165-1.15-.825-1.068-1.98-1.724-3.216-1.888-1.238-.247-2.556.082-3.628.902l-.495.493-2.474 2.464c-1.897 1.969-1.814 5.09.083 6.977.99.904 2.226 1.396 3.463 1.396s2.473-.492 3.463-1.395l1.402-1.396a.79.79 0 000-1.15c-.33-.328-.908-.41-1.237-.082z\",\n    fill: \"#FF753E\",\n    \"fill-rule\": \"nonzero\"\n  }));\n}\nfunction addProtocolToURL(url) {\n  const protocolRegex = /^[a-z0-9]+:\\/\\//;\n  const defaultProtocol = 'http://';\n  if (protocolRegex.test(url)) {\n    return url;\n  }\n  return defaultProtocol + url;\n}\nfunction canHandleRootDrop(e) {\n  const items = toArray(e.dataTransfer.items);\n  const urls = items.filter(item => item.kind === 'string' && item.type === 'text/uri-list');\n  return urls.length > 0;\n}\nfunction checkIfCorrectURL(url) {\n  return (url == null ? void 0 : url.startsWith('http://')) || (url == null ? void 0 : url.startsWith('https://'));\n}\nfunction getFileNameFromUrl(url) {\n  const {\n    pathname\n  } = new URL(url);\n  return pathname.substring(pathname.lastIndexOf('/') + 1);\n}\n\n/*\n * Response from the /url/meta Companion endpoint.\n * Has to be kept in sync with `getURLMeta` in `companion/src/server/helpers/request.js`.\n */\n\nexport default class Url extends UIPlugin {\n  constructor(uppy, opts) {\n    super(uppy, opts);\n    this.getMeta = url => {\n      return this.client.post('url/meta', {\n        url\n      });\n    };\n    this.addFile = async (protocollessUrl, optionalMeta) => {\n      // Do not process local files\n      if (protocollessUrl.startsWith('blob')) {\n        return undefined;\n      }\n      const url = addProtocolToURL(protocollessUrl);\n      if (!checkIfCorrectURL(url)) {\n        this.uppy.log(`[URL] Incorrect URL entered: ${url}`);\n        this.uppy.info(this.i18n('enterCorrectUrl'), 'error', 4000);\n        return undefined;\n      }\n      this.uppy.log(`[URL] Adding file from dropped/pasted url: ${url}`);\n      try {\n        const meta = await this.getMeta(url);\n        const tagFile = {\n          meta: optionalMeta,\n          source: this.id,\n          name: meta.name || getFileNameFromUrl(url),\n          type: meta.type,\n          data: {\n            size: meta.size\n          },\n          isRemote: true,\n          body: {\n            url\n          },\n          remote: {\n            companionUrl: this.opts.companionUrl,\n            url: `${this.hostname}/url/get`,\n            body: {\n              fileId: url,\n              url\n            },\n            requestClientId: Url.requestClientId\n          }\n        };\n        this.uppy.log('[Url] Adding remote file');\n        try {\n          return this.uppy.addFile(tagFile);\n        } catch (err) {\n          if (!err.isRestriction) {\n            this.uppy.log(err);\n          }\n          return err;\n        }\n      } catch (err) {\n        this.uppy.log(err);\n        this.uppy.info({\n          message: this.i18n('failedToFetch'),\n          details: err\n        }, 'error', 4000);\n        return err;\n      }\n    };\n    this.handleRootDrop = e => {\n      forEachDroppedOrPastedUrl(e.dataTransfer, 'drop', url => {\n        this.addFile(url);\n      });\n    };\n    this.handleRootPaste = e => {\n      forEachDroppedOrPastedUrl(e.clipboardData, 'paste', url => {\n        this.addFile(url);\n      });\n    };\n    this.id = this.opts.id || 'Url';\n    this.type = 'acquirer';\n    this.icon = () => h(UrlIcon, null);\n\n    // Set default options and locale\n    this.defaultLocale = locale;\n    this.i18nInit();\n    this.title = this.i18n('pluginNameUrl');\n    this.hostname = this.opts.companionUrl;\n    if (!this.hostname) {\n      throw new Error('Companion hostname is required, please consult https://uppy.io/docs/companion');\n    }\n    this.client = new RequestClient(uppy, {\n      pluginId: this.id,\n      provider: 'url',\n      companionUrl: this.opts.companionUrl,\n      companionHeaders: this.opts.companionHeaders,\n      companionCookiesRule: this.opts.companionCookiesRule\n    });\n    this.uppy.registerRequestClient(Url.requestClientId, this.client);\n  }\n  render() {\n    return h(UrlUI, {\n      i18n: this.i18n,\n      addFile: this.addFile\n    });\n  }\n  install() {\n    const {\n      target\n    } = this.opts;\n    if (target) {\n      this.mount(target, this);\n    }\n  }\n  uninstall() {\n    this.unmount();\n  }\n}\n\n// This is defined outside of the class body because it's not using `this`, but\n// we still want it available on the prototype so the Dashboard can access it.\n_Url = Url;\nUrl.VERSION = packageJson.version;\nUrl.requestClientId = _Url.name;\nUrl.prototype.canHandleRootDrop = canHandleRootDrop;"],
  "mappings": "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",
  "names": ["require_retry_operation", "__commonJSMin", "exports", "module", "RetryOperation", "timeouts", "options", "err", "currentTime", "timeout", "self", "fn", "timeoutOps", "counts", "mainError", "mainErrorCount", "i", "error", "message", "count", "require_retry", "__commonJSMin", "exports", "RetryOperation", "options", "timeouts", "opts", "key", "i", "a", "b", "attempt", "random", "timeout", "obj", "methods", "method", "original", "op", "args", "callback", "err", "require_retry", "__commonJSMin", "exports", "module", "UserFacingApiError", "UserFacingApiError_default", "import_retry", "objectToString", "isError", "value", "errorMessages", "isNetworkError", "error", "AbortError", "message", "decorateErrorWithCounts", "error", "attemptNumber", "options", "retriesLeft", "pRetry", "input", "resolve", "reject", "operation", "retry", "abortHandler", "cleanUp", "result", "isNetworkError", "finalError", "fetchWithNetworkError", "err", "NetworkError_default", "has", "object", "key", "ErrorWithCause", "message", "options", "has", "ErrorWithCause_default", "getSocketHost", "url", "_regex$exec", "host", "AuthError", "AuthError_default", "_classPrivateFieldLooseBase", "id", "_classPrivateFieldLooseKey", "packageJson", "stripSlash", "url", "retryCount", "socketActivityTimeoutMs", "authErrorStatusCode", "HttpError", "_ref", "statusCode", "message", "handleJSONResponse", "res", "AuthError_default", "errMsg", "errData", "cause", "UserFacingApiError_default", "emitSocketProgress", "uploader", "progressData", "file", "progress", "bytesUploaded", "bytesTotal", "_file$progress$upload", "_companionHeaders", "_getUrl", "_requestSocketToken", "_awaitRemoteFileUpload", "RequestClient", "uppy", "opts", "_awaitRemoteFileUpload2", "_getUrl2", "_ref2", "_file$remote", "postBody", "signal", "headers", "companion", "host", "emptyBody", "_ref3", "path", "method", "data", "skipPostResponse", "response", "fetchWithNetworkError", "err", "ErrorWithCause_default", "options", "reqBody", "_this", "getQueue", "pRetry", "_this$uppy$getFile", "existingServerToken", "serverToken", "outerErr", "AbortError", "isRetryableHttpError", "_ref4", "queue", "removeEventHandlers", "capabilities", "resolve", "reject", "token", "getSocketHost", "socket", "socketAbortController", "activityTimeout", "isPaused", "socketSend", "action", "payload", "_socket", "sendState", "createWebsocket", "onFatalError", "_socketAbortControlle", "resetActivityTimeout", "_", "rejectSocket", "error", "_socket2", "e", "_payload$response", "_payload$response$sta", "_payload$response2", "_socketAbortControlle2", "text", "closeSocket", "pause", "newPausedState", "onFileRemove", "targetFile", "_socketAbortControlle3", "onCancelAll", "_socketAbortControlle4", "onFilePausedChange", "onPauseAll", "onResumeAll", "_socketAbortControlle5", "urlAlphabet", "nanoid", "size", "id", "i", "urlAlphabet", "_classPrivateFieldLooseBase", "id", "_classPrivateFieldLooseKey", "_handleSubmit", "UrlUI", "x", "props", "ev", "addFile", "preparedValue", "nanoid", "i18n", "_", "input", "UrlUI_default", "forEachDroppedOrPastedUrl", "dataTransfer", "isDropOrPaste", "callback", "items", "toArray_default", "urlItems", "item", "urlString", "locale_default", "_Url", "packageJson", "UrlIcon", "_", "addProtocolToURL", "url", "protocolRegex", "defaultProtocol", "canHandleRootDrop", "toArray_default", "item", "checkIfCorrectURL", "getFileNameFromUrl", "pathname", "Url", "UIPlugin_default", "uppy", "opts", "protocollessUrl", "optionalMeta", "meta", "tagFile", "err", "e", "forEachDroppedOrPastedUrl", "locale_default", "RequestClient", "UrlUI_default", "target"]
}
